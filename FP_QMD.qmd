---
title: "Covid-19 case study"
subtitle: "Tracking and anlayzing cases throughout the US States"
author: "Naman Khandelwal, Riya Merchant, and Aditi Kumar"
date: "December 14, 2025"
bibliography: references.bib
csl: apa7.csl

format:
  pdf:
    number-sections: true
    fig-align: center
    cap-location: top
    geometry:
      - top=1in
      - left=1in
      - right=1in
      - bottom=1in
    colorlinks: true

execute:
  echo: false
  warning: false

editor: visual
---

## Introduction

This project employs **Exploratory Data Analysis (EDA)** to investigate COVID-19 patterns across U.S. states. We chose the EDA paradigm because our goal is to uncover patterns, generate hypotheses, and understand "what is going on" in the data rather than to confirm pre-existing hypotheses. This approach aligns with our introductory course objectives of building understanding through data-driven exploration.

For coding, we follow the **Tidyverse approach** in R. We chose this paradigm because it emphasizes readable, pipe-based workflows that make data transformations transparent and reproducible. The Tidyverse's grammar of graphics (ggplot2) and data manipulation tools (dplyr, tidyr) allow us to create professional visualizations and maintain clean, well-documented code that others can understand and reproduce.

The New York Times state-level dataset provides a daily record of cases and deaths for each state, which allows for a data-driven exploration of how the virus spread. Since this project uses those public counts to describe broad patterns, we can focus on simple summaries that are appropriate for an introductory course. Then, the analysis begins with an overview of the dataset, which would then move to geographic comparisons and trends over time. Each team member is responsible for a distinct part of the workflow, like data cleaning or visualization. Thus, throughout the report, the team emphasizes clear documentation and ethical use of data, which allows others to re-run the analysis on the same file using our code.

## Data Provenance

In this project, we use a COVID-19 dataset from The New York Times which contains cumulative counts of cases and deaths for each state. Then, since our file covers the period from January 21, 2020 to March 23, 2023, we can get the data based on the minimum and maximum dates. Then, because the values are aggregated from health agencies, they are made available as a CSV file on GitHub, which would allow us to use it [@nytimes2023covid].

## FAIR and CARE Principles

For this project, the NYTimes data is consistent with FAIR principles because it is widely accessible online. Since it uses stable identifiers like state names and follows a table structure, this would allow it to be combined with other data like population estimates for analysis. Then, the data is also findable and reusable because it comes from a good publisher with clear updates, which allows it to support questions about patterns in the pandemic. At the same time, it is important to look at CARE principles by realizing that COVID results show differences across communities. Then, since we want to avoid blaming specific states, we should focus on context like healthcare access and health differences. Thus, when looking at results, the team will frame the analysis to respect communities, which avoids claiming too much and shows how clear data can help public health responses.

## Descriptive Statistics

Before diving into state-level comparisons, we examined the overall distribution of daily new COVID-19 cases across all states throughout the entire pandemic period. This provides baseline understanding of the data's central tendency and spread.

```{r}
# Code Style Guide: Tidyverse Style Guide
# Primary Author: Naman
# Reviewer: Riya

library(tidyverse)
library(lubridate)
library(janitor)
library(knitr)
library(kableExtra)

#| label: descriptive-stats
#| tbl-cap: "Table 1. Descriptive statistics for daily new COVID-19 cases across all states."
# Read Data Once
us_states <- read_csv(
  "https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-states.csv",
  show_col_types = FALSE
) %>%
  clean_names()

# Master Data Cleaning
# Had to figure out how to get daily new cases since data only had cumulative
# Used lag() to subtract previous day - took a while to get this working right
# Also noticed some negative values (prob data corrections) so set those to 0
covid_clean <- us_states %>%
  mutate(date = parse_date_time(date, orders = c("ymd", "mdy"))) %>% 
  mutate(date = as.Date(date)) %>%
  arrange(state, date) %>%
  group_by(state) %>%
  mutate(
    new_cases = cases - lag(cases, default = 0),
    new_deaths = deaths - lag(deaths, default = 0)
  ) %>%
  ungroup() %>%
  mutate(new_cases = ifelse(new_cases < 0, 0, new_cases))

covid_clean %>%
  summarize(
    n_observations = n(),
    mean_daily_cases = mean(new_cases, na.rm = TRUE),
    median_daily_cases = median(new_cases, na.rm = TRUE),
    sd_daily_cases = sd(new_cases, na.rm = TRUE),
    min_cases = min(new_cases, na.rm = TRUE),
    max_cases = max(new_cases, na.rm = TRUE)
  ) %>%
  kable(
    caption = "Descriptive Statistics: Daily New Cases Across All States",
    col.names = c("N", "Mean", "Median", "SD", "Min", "Max"),
    digits = 0
  ) %>%
  kable_styling(full_width = FALSE)
```

The descriptive statistics reveal that daily new cases varied widely, with a mean of several hundred cases but high variability as indicated by the standard deviation. The median being lower than the mean suggests a right-skewed distribution, where most days had moderate case counts but occasional surges drove the mean higher. This pattern aligns with the wave-like nature of pandemic spread.

## Comparative State Analysis and Setup (Naman)

This section explores geographic differences in COVID-19 spread across U.S. states. We highlight which states had the highest overall case counts and visualize how the pandemic evolved across the most affected states. This analysis also sets up and cleans the raw data from GitHub to ensure it is formatted correctly for use in the following tables and visualizations.

```{r}
# Code Style Guide: Tidyverse Style Guide
# Primary Author: Naman
# Reviewer: Riya
# ---- Global Setup & Data Loading ----
# Goal: Get COVID data loaded and ready for analysis
# Plan was to pull straight from NYTimes GitHub so it's always fresh
# Then clean up dates and calculate daily new cases (not just cumulative)
# Reused this covid_clean object everywhere to avoid reading data multiple times

#| label: naman-overview
#| table.alt: "A summary table showing the top 10 US states by total COVID-19 cases, including total deaths and the date range of reporting. California, Texas, and Florida typically lead the list."

# Create one-row-per-state summary
state_summary <- covid_clean %>%
  group_by(state) %>%
  summarise(
    total_cases = max(cases, na.rm = TRUE),
    total_deaths = max(deaths, na.rm = TRUE),
    first_date = min(date, na.rm = TRUE),
    last_date = max(date, na.rm = TRUE)
  ) %>%
  arrange(desc(total_cases))

# Show top 10 states by total cases
state_summary %>%
  slice_head(n = 10) %>%
  kable(
    caption = "Table 1: Overview of NYTimes state-level COVID-19 data (Top 10 States).",
    col.names = c("State", "Total Cases", "Total Deaths", "First Report", "Last Report")
  ) %>%
  kable_styling(latex_options = "scale_down")

# ---- Visualization: Cumulative Trends ----
#| fig-cap: "Figure 1. Cumulative COVID-19 cases comparing Pennsylvania, New York, and California from 2020-2023."
#| fig.alt: "Line chart showing cumulative COVID-19 cases from 2020 to 2023. Three lines represent Pennsylvania, New York, and California. California shows the highest total volume, with all three states following a similar upward trajectory punctuated by steep climbs during winter surges."

states_of_interest <- c("Pennsylvania", "New York", "California")

plot_data_naman <- covid_clean %>%
  filter(state %in% states_of_interest)

ggplot(plot_data_naman, aes(x = date, y = cases, color = state)) +
  geom_line(linewidth = 1) +
  labs(
    title = "Cumulative COVID-19 Cases Over Time",
    subtitle = "Comparing Pennsylvania, New York, and California",
    x = "Date",
    y = "Cumulative Cases",
    caption = "Data source: NYTimes"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom")
```

## Geographic EDA (Riya)

This section explores geographic differences in COVID-19 spread across U.S. states.\
We highlight which states had the highest overall case counts and visualize how the pandemic evolved across the most affected states.

```{r}
# Code Style Guide: Tidyverse Style Guide
# Primary Author: Riya
# Reviewer: Aditi
#| label: riya-geo-eda
# ---- Riya Table: Peak Days ----
# This table finds the single worst day for the top 10 states.
# It helps us answer: "When was the pandemic at its absolute worst?"
top_states_list <- state_summary %>% 
  slice_head(n = 10) %>% 
  pull(state)

peak_days <- covid_clean %>%
  filter(state %in% top_states_list) %>%
  group_by(state) %>%
  filter(new_cases == max(new_cases, na.rm = TRUE)) %>%
  select(state, date, peak_cases = new_cases) %>%
  arrange(desc(peak_cases))

kable(peak_days,
      caption = "Table 2: The Single Worst Day of Infections for the Top 10 States.",
      col.names = c("State", "Date of Peak", "Max Daily Cases")) %>%
  kable_styling(full_width = FALSE)


# After the table, wanted to visualize total impact - bar chart felt most straightforward
# ---- Riya Graph: Total Impact Comparison (Bar Chart) ----
#| fig-cap: "Figure 2. Total COVID-19 cases across the top 15 U.S. states."
# Instead of a messy line graph, we use a Horizontal Bar Chart.
# This clearly compares the magnitude of the pandemic across states.

# 1. Filter to top 15 states so the chart fits on the page
bar_data <- covid_clean %>%
  group_by(state) %>%
  summarize(total_cases = max(cases, na.rm = TRUE)) %>%
  arrange(desc(total_cases)) %>%
  slice_head(n = 15)

# 2. Plot
ggplot(bar_data, aes(x = reorder(state, total_cases), y = total_cases)) +
  geom_col(fill = "steelblue") +   # geom_col creates the bars
  coord_flip() +                   # FLIP chart so state names are easy to read
  labs(
    title = "Total COVID-19 Cases: Top 15 States",
    subtitle = "Comparing the total scale of the pandemic across major states",
    x = "State",
    y = "Total Cases (Cumulative)"
  ) +
  scale_y_continuous(labels = scales::comma) + # Adds commas to the big numbers (e.g. 10,000,000)
  theme_minimal()
#| label: time-analysis
#| fig-alt: "Bar chart showing total new COVID-19 cases per week in the United States, with the largest bars occurring during winter surge periods."
#| fig-cap: "Figure 3. National weekly COVID-19 case volume."

```

## Temporal Trend Analysis (Aditi)

This section shifts the focus from geography to time, aggregating the data to identify broader patterns in the pandemic. By grouping the cleaned GitHub data into weekly and monthly intervals, we can more clearly see the "waves" of infection and the magnitude of seasonal surges across the United States.

```{r}
# Code Style Guide: Tidyverse Style Guide
# Primary Author: Aditi
# Reviewer: Naman

# ---- Weekly Aggregation ----
weekly <- covid_clean %>%
  group_by(week = floor_date(date, "week")) %>%
  summarize(
    weekly_new_cases = sum(new_cases, na.rm = TRUE),
    weekly_new_deaths = sum(new_deaths, na.rm = TRUE),
    .groups = "drop"
  )

# ---- Weekly Summary Table ----
#| table.alt: "A summary table showing the first 10 weeks of the COVID-19 pandemic in the US, listing the start date of each week alongside the total new cases and deaths reported."
kable(
  head(weekly, 10),
  caption = "Table 2. First 10 Weeks of National COVID-19 Volume",
  col.names = c("Week", "New Cases", "New Deaths")
) %>%
  kable_styling(full_width = FALSE)

# ---- Visualization: Weekly Volume (Bar Chart) ----
#| fig.alt: "A bar chart titled National Weekly COVID-19 Volume. The x-axis shows the timeline from 2020 to 2023, and the y-axis shows weekly cases. The bars show distinct spikes, with the largest peak occurring during the winter of 2021-2022."
ggplot(weekly, aes(x = week, y = weekly_new_cases)) +
  geom_col(fill = "#4E79A7") +
  labs(
    title = "National Weekly COVID-19 Volume",
    x = "Week",
    y = "Total New Cases per Week",
    caption = "Bar chart highlights the magnitude of winter COVID-19 surges."
  ) +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()

# ---- Monthly Aggregation ----
monthly <- covid_clean %>%
  group_by(month = floor_date(date, "month")) %>%
  summarize(
    monthly_new_cases = sum(new_cases, na.rm = TRUE),
    .groups = "drop"
  )

# ---- Visualization: Monthly Trends ----
#| fig.alt: "A line plot showing monthly total COVID-19 cases in the United States. The dark red line smooths out the weekly volatility, clearly illustrating the major pandemic waves and the gradual decline in case volume toward 2023."
#| fig.cap: "Figure 4. Monthly COVID-19 case trends in the United States."
ggplot(monthly, aes(x = month, y = monthly_new_cases)) +
  geom_line(color = "darkred", linewidth = 1) +
  geom_point(color = "darkred") +
  labs(
    title = "Monthly COVID-19 Cases",
    subtitle = "Smoothed view of pandemic waves",
    x = "Month",
    y = "Total Cases per Month"
  ) +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

### Narrative: How COVID-19 Changed Over Time

COVID-19 did not spread evenly over time. By examining weekly and monthly totals, several clear patterns emerge:

Distinct waves: Both the weekly and monthly plots show multiple sharp increases corresponding to major national waves.

Early slow growth: Initial case counts rise gradually, reflecting limited spread and limited testing early in the pandemic.

Large mid-pandemic surges: Several large spikes represent periods when infections accelerated nationwide.

Deaths lag behind cases: While both grow over time, deaths tend to rise shortly after cases, consistent with clinical expectations.

Seasonal patterns: Some of the largest increases align with colder months, when indoor transmission increases. These large mid-pandemic surges may be driven by several factors: increased testing availability making more cases detectable, new variant emergence with higher transmissibility, or relaxation of public health measures. The winter seasonality pattern observed in Figures 3 and 4 suggests that indoor gathering during colder months may amplify transmission, a hypothesis that could be tested by comparing states with different climate profiles.

This temporal EDA highlights how the pandemic progressed through time and supports deeper analysis of patterns and risks.

# References

::: {#refs}
:::

# Author Contributions

Using the CRediT (Contributor Roles Taxonomy), the team contributions are as follows:

-   **Naman Khandelwal**: Conceptualization, Data curation, Formal analysis (comparative state analysis), Methodology, Software, Visualization (cumulative trends plot), Writing - original draft, Writing - review & editing

-   **Riya Merchant**: Data curation, Formal analysis (geographic EDA), Investigation, Visualization (bar charts and peak day analysis), Writing - original draft

-   **Aditi Kumar**: Data curation, Formal analysis (temporal trends), Software, Visualization (weekly and monthly aggregations), Writing - original draft

All team members contributed to project administration and validation.

# Code Appendix

```{r}
#| echo: TRUE
#| eval: FALSE
#| label: code-appendix
# ==============================================================================
# SECTION 1: GLOBAL SETUP & DATA PROVENANCE
# ==============================================================================

library(tidyverse)
library(lubridate)
library(janitor)
library(knitr)
library(kableExtra)

# Read Data from NYTimes GitHub
us_states <- read_csv(
  "https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-states.csv",
  show_col_types = FALSE
) %>%
  clean_names()

# Master Data Cleaning
# 1. Parse dates safely
# 2. Calculate daily incidence (New Cases/Deaths) using lag()
covid_clean <- us_states %>%
  mutate(date = parse_date_time(date, orders = c("ymd", "mdy"))) %>% 
  mutate(date = as.Date(date)) %>%
  arrange(state, date) %>%
  group_by(state) %>%
  mutate(
    new_cases = cases - lag(cases, default = 0),
    new_deaths = deaths - lag(deaths, default = 0)
  ) %>%
  ungroup() %>%
  # Remove negative corrections
  mutate(new_cases = ifelse(new_cases < 0, 0, new_cases))

# ==============================================================================
# SECTION 2: OVERVIEW & CUMULATIVE TRENDS (NAMAN)
# ==============================================================================

# Create one-row-per-state summary
state_summary <- covid_clean %>%
  group_by(state) %>%
  summarise(
    total_cases = max(cases, na.rm = TRUE),
    total_deaths = max(deaths, na.rm = TRUE),
    first_date = min(date, na.rm = TRUE),
    last_date = max(date, na.rm = TRUE)
  ) %>%
  arrange(desc(total_cases))

# Table 1: Top 10 States Overview
state_summary %>%
  slice_head(n = 10) %>%
  kable(
    caption = "Table 1: Overview of NYTimes state-level COVID-19 data (Top 10 States).",
    col.names = c("State", "Total Cases", "Total Deaths", "First Report", "Last Report")
  ) %>%
  kable_styling(latex_options = "scale_down")

# Visualization: Cumulative Trends for PA, NY, CA
states_of_interest <- c("Pennsylvania", "New York", "California")

plot_data_naman <- covid_clean %>%
  filter(state %in% states_of_interest)

ggplot(plot_data_naman, aes(x = date, y = cases, color = state)) +
  geom_line(linewidth = 1) +
  labs(
    title = "Cumulative COVID-19 Cases Over Time",
    subtitle = "Comparing Pennsylvania, New York, and California",
    x = "Date",
    y = "Cumulative Cases",
    caption = "Data source: NYTimes"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom")

# ==============================================================================
# SECTION 3: GEOGRAPHIC EDA (RIYA)
# ==============================================================================

# Table 2: Peak Infection Days
top_states_list <- state_summary %>% 
  slice_head(n = 10) %>% 
  pull(state)

peak_days <- covid_clean %>%
  filter(state %in% top_states_list) %>%
  group_by(state) %>%
  filter(new_cases == max(new_cases, na.rm = TRUE)) %>%
  select(state, date, peak_cases = new_cases) %>%
  arrange(desc(peak_cases))

kable(peak_days,
      caption = "Table 2: The Single Worst Day of Infections for the Top 10 States.",
      col.names = c("State", "Date of Peak", "Max Daily Cases")) %>%
  kable_styling(full_width = FALSE)

# Graph: Total Impact Comparison (Horizontal Bar Chart)
bar_data <- covid_clean %>%
  group_by(state) %>%
  summarize(total_cases = max(cases, na.rm = TRUE)) %>%
  arrange(desc(total_cases)) %>%
  slice_head(n = 15)

ggplot(bar_data, aes(x = reorder(state, total_cases), y = total_cases)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  labs(
    title = "Total COVID-19 Cases: Top 15 States",
    subtitle = "Comparing the total scale of the pandemic across major states",
    x = "State",
    y = "Total Cases (Cumulative)"
  ) +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()

# ==============================================================================
# SECTION 4: TEMPORAL ANALYSIS (ADITI)
# ==============================================================================

# Weekly Aggregation
weekly <- covid_clean %>%
  group_by(week = floor_date(date, "week")) %>%
  summarize(
    weekly_new_cases = sum(new_cases, na.rm = TRUE),
    weekly_new_deaths = sum(new_deaths, na.rm = TRUE)
  )

# Table 3: First 10 Weeks
kable(head(weekly, 10),
      caption = "Table 3. First 10 Weeks of National COVID-19 Volume",
      col.names = c("Week", "New Cases", "New Deaths")) %>%
  kable_styling(full_width = FALSE)

# Visualization: Weekly Volume
ggplot(weekly, aes(x = week, y = weekly_new_cases)) +
  geom_col(fill = "#4E79A7") +
  labs(
    title = "National Weekly COVID-19 Volume",
    x = "Week",
    y = "Total New Cases per Week",
    caption = "Bar chart highlights the magnitude of the winter surges."
  ) +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()

# Monthly Aggregation & Visualization
monthly <- covid_clean %>%
  group_by(month = floor_date(date, "month")) %>%
  summarize(
    monthly_new_cases = sum(new_cases, na.rm = TRUE)
  )

ggplot(monthly, aes(x = month, y = monthly_new_cases)) +
  geom_line(color = "darkred", linewidth = 1) +
  geom_point(color = "darkred") +
  labs(
    title = "Monthly COVID-19 Cases",
    subtitle = "Smoothed view of pandemic waves",
    x = "Month",
    y = "Total Cases per Month"
  ) +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```
